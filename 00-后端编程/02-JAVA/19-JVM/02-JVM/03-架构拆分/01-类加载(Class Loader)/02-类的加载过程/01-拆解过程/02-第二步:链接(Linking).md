![](https://youpaiyun.zongqilive.cn/image/20210115165626.png)



## 验证

校验字节码文件的正确性 , 保证加载类的正确性, 不会危害虚拟机自身安全

主要包括四种验证: 文件格式验证, 元数据验证, 字节码验证, 符号引用验证

## 准备

给类的静态变量分配内存，并赋予默认值 

这里不包含用`final`修饰的static, 因为`final`在编译的时候就会分配, 准备阶段会显式初始化

这里不会为实例变量分配初始化,  类变量会在分配在方法区中, 而实例变量是会随着对象一起分配到堆中

## 解析

确保类的继承、组合等关联类、接口能被正确找到，解析的过程可能会导致其它的 Java 类被加载

- 将常量池中的符号引用（symbolic reference）替换为直接引用。--(静态链接)

  - 静态链接过程: 该阶段会把一些静态方法(符号引用，比如main()方法)替换为指向数据所存内存的指针或句柄等(直接引用)，这是所谓的静态链接过程(类加载期间完成)
  - 动态链接是在程序运行期间完成的将符号引用替换为直接 引用

  - 符号引用就是唯一的字符串，直接引用可以理解为一个地址值和偏移量

![](https://youpaiyun.zongqilive.cn/image/20210115170956.png)



 

> 只会将变量的值赋值为初始值(零值), 但如果以final修饰该变量，则链接阶段就会显示的初始化该常量的值



```java
public class HelloApp {
	private static int a=1:;//链接阶段只会将a赋值为0
	private static Date d = new Date();//连接阶段只会将d赋值为null
	public final int b = 5;//连接阶段会直接将常量值初始化为5
	public static void main(String[] args) {}
}
```

















































