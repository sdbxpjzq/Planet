### 偏向锁

```
小明今天吃坏了东西需要反复去厕所，如果小明每次都要开锁就很耽误时间，
于是门锁将小明的脸记录下来（假设那个锁是智能锁），下次小明再来的时候门锁会自动识别出是小明来了，然后自动开锁，这样就省去了小明拿钥匙开门的过程，
此时门锁就是偏向锁，也可以理解为偏向小明的锁。
```



### 轻量级锁

```
接下来，小红又去上厕所，试图将厕所的门锁设置为偏向自己的偏向锁，于是发现门锁无法偏向自己，因为此时门锁已是偏向小明的偏向锁
于是小红很生气，要求门锁撤销对小明的偏向，当然，小明也不同意门锁偏向小红
于是等小明用完厕所之后，门锁撤销了对任何人的偏向（只要出现竞争的情况，就会撤销偏向锁）
这个过程就是撤销偏向锁。此时门锁升级为轻量级锁。

```



### 自旋

```
等小明出来以后，轻量级锁正式生效 。下一次小明和小红同时来厕所，谁跑的快谁先走到门前，开门后将门锁拿进厕所，并将门锁打开以后拿进厕所里，将门反锁，于是在门外原来放门锁的位置放置了一个有人的标志（这个标识可以理解为指向门锁的指针，或者理解为作为锁的Java对象头的Mark Word值）
这时，小红看到有人以后很着急，催着里面的人出来时马上进去，于是不断的来敲门，问小明什么时候出来。这个过程就是自旋。
```



### 重量级锁

```
反复敲了几次以后，小明受不了了，对小红喊话，说你别敲了，等我用完厕所我告诉你，于是小红去一边等着（线性阻塞）。
此时门锁升级为重量级锁。升级为重量级锁的后果就是，小红不再反复敲门，小明在上完厕所以后必须告诉小红一声，否则小红就会一直等着。
```



## 结论

```
偏向锁在只有一个人上厕所时非常高效，省去了开门的过程。

轻量级锁在有多人上厕所但是每个人使用的特别快的时候，比较高效，因为会出现这种现象，小红敲门的时候正好赶上小明出来，这样就省得小明出来告诉小红以后小红才能进去，但是这样可能会出现小红敲门失败的情况（就是敲门时小明还没用完）。

重量级锁相比与轻量级锁的多了一步小明呼唤小红的步骤，但是却省掉了小红反复去敲门的过程，但是能保证小红去厕所时厕所一定是没人的。
```







