直接内存（Direct Memory）并不是虚拟机运行时数据区的一部分。

Java里用`DirectByteBuffer`可以分配一块直接内存(堆外内存)，元空间对应的内存也叫作直接内存，它们对应的都是机器的物理内存





![](https://youpaiyun.zongqilive.cn/image/20210123155848.png)

减少了2次用户态拷贝拷贝

![](https://youpaiyun.zongqilive.cn/image/20210123160117.png)



使用直接内存的优缺点： 优点：

- 不占用堆内存空间，减少了发生GC的可能
-  java虚拟机实现上，本地IO会直接操作直接内存（直接内存=>系统调用=>硬盘/网卡），而非直接内存则需要二次拷贝（堆内 存=>直接内存=>系统调用=>硬盘/网卡）

缺点：

- 初始分配较慢 
- 没有JVM直接帮助管理内存，容易发生内存溢出。为了避免一直没有FULL GC，最终导致直接内存把物理内存被耗完。我们可 以指定直接内存的最大值，通过-XX：MaxDirectMemorySize来指定，当达到阈值的时候，调用system.gc来进行一次FULL GC， 间接把那些没有被使用的直接内存回收掉。

















